{"version":3,"sources":["../../../src/server/lib/app-info-log.ts"],"sourcesContent":["import { loadEnvConfig } from '@next/env'\nimport * as inspector from 'inspector'\nimport * as Log from '../../build/output/log'\nimport { bold, purple, strikethrough } from '../../lib/picocolors'\nimport type { ConfiguredExperimentalFeature } from '../config'\nimport { experimentalSchema } from '../config-schema'\n\n// Re-export the type for consumers\nexport type { ConfiguredExperimentalFeature }\n\n/**\n * Logs basic startup info that doesn't require config.\n * Called before \"Ready in X\" to show immediate feedback.\n */\nexport function logStartInfo({\n  networkUrl,\n  appUrl,\n  envInfo,\n  logBundler,\n}: {\n  networkUrl: string | null\n  appUrl: string | null\n  envInfo?: string[]\n  logBundler: boolean\n}) {\n  let versionSuffix = ''\n  const parts = []\n\n  if (logBundler) {\n    if (process.env.TURBOPACK) {\n      parts.push('Turbopack')\n    } else if (process.env.NEXT_RSPACK) {\n      parts.push('Rspack')\n    } else {\n      parts.push('webpack')\n    }\n  }\n\n  if (parts.length > 0) {\n    versionSuffix = ` (${parts.join(', ')})`\n  }\n\n  Log.bootstrap(\n    `${bold(\n      purple(`${Log.prefixes.ready} Next.js ${process.env.__NEXT_VERSION}`)\n    )}${versionSuffix}`\n  )\n  if (appUrl) {\n    Log.bootstrap(`- Local:         ${appUrl}`)\n  }\n  if (networkUrl) {\n    Log.bootstrap(`- Network:       ${networkUrl}`)\n  }\n  const inspectorUrl = inspector.url()\n  if (inspectorUrl) {\n    // Could also parse this port from the inspector URL.\n    // process.debugPort will always be defined even if the process is not being inspected.\n    // The full URL seems noisy as far as I can tell.\n    // Node.js will print the full URL anyway.\n    const debugPort = process.debugPort\n    Log.bootstrap(`- Debugger port: ${debugPort}`)\n  }\n  if (envInfo?.length) Log.bootstrap(`- Environments: ${envInfo.join(', ')}`)\n}\n\n/**\n * Logs experimental features and config-dependent info.\n * Called after getRequestHandlers completes.\n */\nexport function logExperimentalInfo({\n  experimentalFeatures,\n  cacheComponents,\n}: {\n  experimentalFeatures?: ConfiguredExperimentalFeature[]\n  cacheComponents?: boolean\n}) {\n  if (cacheComponents) {\n    Log.bootstrap(`- Cache Components enabled`)\n  }\n\n  if (experimentalFeatures?.length) {\n    Log.bootstrap(`- Experiments (use with caution):`)\n    for (const exp of experimentalFeatures) {\n      const isValid = Object.prototype.hasOwnProperty.call(\n        experimentalSchema,\n        exp.key\n      )\n      if (isValid) {\n        const symbol =\n          typeof exp.value === 'boolean'\n            ? exp.value === true\n              ? bold('✓')\n              : bold('⨯')\n            : '·'\n\n        const suffix =\n          typeof exp.value === 'number' || typeof exp.value === 'string'\n            ? `: ${JSON.stringify(exp.value)}`\n            : ''\n\n        const reason = exp.reason ? ` (${exp.reason})` : ''\n\n        Log.bootstrap(`  ${symbol} ${exp.key}${suffix}${reason}`)\n      } else {\n        Log.bootstrap(\n          `  ? ${strikethrough(exp.key)} (invalid experimental key)`\n        )\n      }\n    }\n  }\n\n  // New line after the bootstrap info\n  Log.info('')\n}\n\n/**\n * Gets environment info for logging. Fast operation that doesn't require config.\n */\nexport function getEnvInfo(dir: string): string[] {\n  const { loadedEnvFiles } = loadEnvConfig(dir, true, console, false)\n  return loadedEnvFiles.map((f) => f.path)\n}\n"],"names":["getEnvInfo","logExperimentalInfo","logStartInfo","networkUrl","appUrl","envInfo","logBundler","versionSuffix","parts","process","env","TURBOPACK","push","NEXT_RSPACK","length","join","Log","bootstrap","bold","purple","prefixes","ready","__NEXT_VERSION","inspectorUrl","inspector","url","debugPort","experimentalFeatures","cacheComponents","exp","isValid","Object","prototype","hasOwnProperty","call","experimentalSchema","key","symbol","value","suffix","JSON","stringify","reason","strikethrough","info","dir","loadedEnvFiles","loadEnvConfig","console","map","f","path"],"mappings":"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","ignoreList":[0]}