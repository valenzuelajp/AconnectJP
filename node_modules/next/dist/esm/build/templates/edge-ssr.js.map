{"version":3,"sources":["../../../../src/build/templates/edge-ssr.ts"],"sourcesContent":["import '../../server/web/globals'\nimport {\n  adapter,\n  type EdgeHandler,\n  type NextRequestHint,\n} from '../../server/web/adapter'\nimport { IncrementalCache } from '../../server/lib/incremental-cache'\nimport { initializeCacheHandlers } from '../../server/use-cache/handlers'\n\nimport Document from 'VAR_MODULE_DOCUMENT'\nimport * as appMod from 'VAR_MODULE_APP'\nimport * as userlandPage from 'VAR_USERLAND'\nimport * as userlandErrorPage from 'VAR_MODULE_GLOBAL_ERROR'\n\ndeclare const userland500Page: any\ndeclare const incrementalCacheHandler: any\n// OPTIONAL_IMPORT:* as userland500Page\n// OPTIONAL_IMPORT:incrementalCacheHandler\n\nimport RouteModule, {\n  type PagesRouteHandlerContext,\n} from '../../server/route-modules/pages/module'\nimport { WebNextRequest, WebNextResponse } from '../../server/base-http/web'\n\nimport type { NextFetchEvent } from '../../server/web/spec-extension/fetch-event'\nimport type RenderResult from '../../server/render-result'\nimport type { RenderResultMetadata } from '../../server/render-result'\nimport { getTracer, SpanKind, type Span } from '../../server/lib/trace/tracer'\nimport { BaseServerSpan } from '../../server/lib/trace/constants'\nimport { HTML_CONTENT_TYPE_HEADER } from '../../lib/constants'\nimport type { RequestMeta } from '../../server/request-meta'\nimport { toNodeOutgoingHttpHeaders } from '../../server/web/utils'\n\n// injected by the loader afterwards.\ndeclare const pageRouteModuleOptions: any\ndeclare const errorRouteModuleOptions: any\ndeclare const user500RouteModuleOptions: any\n// INJECT:pageRouteModuleOptions\n// INJECT:errorRouteModuleOptions\n// INJECT:user500RouteModuleOptions\n\nconst pageMod = {\n  ...userlandPage,\n  routeModule: new RouteModule({\n    ...pageRouteModuleOptions,\n    components: {\n      App: appMod.default,\n      Document,\n    },\n    userland: userlandPage,\n    distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n    relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n  }),\n}\n\nconst errorMod = {\n  ...userlandErrorPage,\n  routeModule: new RouteModule({\n    ...errorRouteModuleOptions,\n    components: {\n      App: appMod.default,\n      Document,\n    },\n    userland: userlandErrorPage,\n    distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n    relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n  }),\n}\n\n// FIXME: this needs to be made compatible with the template\nconst error500Mod = userland500Page\n  ? {\n      ...userland500Page,\n      routeModule: new RouteModule({\n        ...user500RouteModuleOptions,\n        components: {\n          App: appMod.default,\n          Document,\n        },\n        userland: userland500Page,\n        distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n        relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n      }),\n    }\n  : null\n\nexport const ComponentMod = pageMod\n\nasync function requestHandler(\n  req: NextRequestHint,\n  _event: NextFetchEvent\n): Promise<Response> {\n  let srcPage = 'VAR_DEFINITION_PATHNAME'\n\n  const relativeUrl = `${req.nextUrl.pathname}${req.nextUrl.search}`\n  const baseReq = new WebNextRequest(req)\n  const pageRouteModule = pageMod.routeModule as RouteModule\n  const prepareResult = await pageRouteModule.prepare(baseReq, null, {\n    srcPage,\n    multiZoneDraftMode: false,\n  })\n\n  if (!prepareResult) {\n    return new Response('Bad Request', {\n      status: 400,\n    })\n  }\n  const {\n    query,\n    params,\n    buildId,\n    nextConfig,\n    deploymentId,\n    isNextDataRequest,\n    buildManifest,\n    prerenderManifest,\n    reactLoadableManifest,\n    subresourceIntegrityManifest,\n    dynamicCssManifest,\n  } = prepareResult\n\n  initializeCacheHandlers(nextConfig.cacheMaxMemorySize)\n\n  const renderContext: PagesRouteHandlerContext = {\n    page: srcPage,\n    query,\n    params,\n\n    sharedContext: {\n      buildId,\n      deploymentId,\n      customServer: undefined,\n    },\n\n    renderContext: {\n      isFallback: false,\n      isDraftMode: false,\n      developmentNotFoundSourcePage: undefined,\n    },\n\n    renderOpts: {\n      params,\n      page: srcPage,\n      supportsDynamicResponse: true,\n      Component: pageMod.Component,\n      ComponentMod: pageMod,\n      pageConfig: pageMod.pageConfig,\n      routeModule: pageMod.routeModule,\n      previewProps: prerenderManifest.preview,\n      basePath: nextConfig.basePath,\n      assetPrefix: nextConfig.assetPrefix,\n      images: nextConfig.images,\n      optimizeCss: nextConfig.experimental.optimizeCss,\n      nextConfigOutput: nextConfig.output,\n      nextScriptWorkers: nextConfig.experimental.nextScriptWorkers,\n      disableOptimizedLoading: nextConfig.experimental.disableOptimizedLoading,\n      domainLocales: nextConfig.i18n?.domains,\n      distDir: '',\n      crossOrigin: nextConfig.crossOrigin ? nextConfig.crossOrigin : undefined,\n      largePageDataBytes: nextConfig.experimental.largePageDataBytes,\n\n      isExperimentalCompile: nextConfig.experimental.isExperimentalCompile,\n      // `htmlLimitedBots` is passed to server as serialized config in string format\n      experimental: {\n        clientTraceMetadata: nextConfig.experimental.clientTraceMetadata,\n      },\n\n      buildManifest,\n      subresourceIntegrityManifest,\n      reactLoadableManifest,\n      dynamicCssManifest,\n    },\n  }\n  let finalStatus = 200\n\n  const renderResultToResponse = (\n    result: RenderResult<RenderResultMetadata>\n  ): Response => {\n    // Handle null responses\n    if (result.isNull) {\n      finalStatus = 500\n      return new Response(null, { status: 500 })\n    }\n\n    // Extract metadata\n    const { metadata } = result\n    finalStatus = metadata.statusCode || 200\n    const headers = new Headers()\n\n    // Set content type\n    const contentType = result.contentType || HTML_CONTENT_TYPE_HEADER\n    headers.set('Content-Type', contentType)\n\n    // Add metadata headers\n    if (metadata.headers) {\n      for (const [key, value] of Object.entries(metadata.headers)) {\n        if (value !== undefined) {\n          if (Array.isArray(value)) {\n            // Handle multiple header values\n            for (const v of value) {\n              headers.append(key, String(v))\n            }\n          } else {\n            headers.set(key, String(value))\n          }\n        }\n      }\n    }\n\n    // Handle static response\n    if (!result.isDynamic) {\n      const body = result.toUnchunkedString()\n      headers.set(\n        'Content-Length',\n        String(new TextEncoder().encode(body).length)\n      )\n      return new Response(body, {\n        status: finalStatus,\n        headers,\n      })\n    }\n\n    // Handle dynamic/streaming response\n    // For edge runtime, we need to create a readable stream that pipes from the result\n    const { readable, writable } = new TransformStream()\n\n    // Start piping the result to the writable stream\n    // This is done asynchronously to avoid blocking the response creation\n    result.pipeTo(writable).catch((err) => {\n      console.error('Error piping RenderResult to response:', err)\n    })\n\n    return new Response(readable, {\n      status: finalStatus,\n      headers,\n    })\n  }\n\n  const invokeRender = async (span?: Span): Promise<Response> => {\n    try {\n      const result = await pageRouteModule\n        .render(\n          // @ts-expect-error we don't type this for edge\n          baseReq,\n          new WebNextResponse(undefined),\n          {\n            ...renderContext,\n            renderOpts: {\n              ...renderContext.renderOpts,\n              getServerSideProps: pageMod.getServerSideProps,\n              Component: pageMod.default || pageMod,\n              ComponentMod: pageMod,\n              pageConfig: pageMod.config,\n              isNextDataRequest,\n            },\n          }\n        )\n        .finally(() => {\n          if (!span) return\n\n          span.setAttributes({\n            'http.status_code': finalStatus,\n            'next.rsc': false,\n          })\n\n          const rootSpanAttributes = tracer.getRootSpanAttributes()\n          // We were unable to get attributes, probably OTEL is not enabled\n          if (!rootSpanAttributes) {\n            return\n          }\n\n          if (\n            rootSpanAttributes.get('next.span_type') !==\n            BaseServerSpan.handleRequest\n          ) {\n            console.warn(\n              `Unexpected root span type '${rootSpanAttributes.get(\n                'next.span_type'\n              )}'. Please report this Next.js issue https://github.com/vercel/next.js`\n            )\n            return\n          }\n\n          const route = rootSpanAttributes.get('next.route')\n          if (route) {\n            const name = `${req.method} ${route}`\n\n            span.setAttributes({\n              'next.route': route,\n              'http.route': route,\n              'next.span_name': name,\n            })\n            span.updateName(name)\n          } else {\n            span.updateName(`${req.method} ${srcPage}`)\n          }\n        })\n\n      return renderResultToResponse(result)\n    } catch (err) {\n      const errModule = error500Mod || errorMod\n      const errRouteModule = errModule.routeModule as RouteModule\n\n      if (errRouteModule.isDev) {\n        throw err\n      }\n\n      const silenceLog = false\n      await errRouteModule.onRequestError(\n        baseReq,\n        err,\n        {\n          routerKind: 'Pages Router',\n          routePath: srcPage,\n          routeType: 'render',\n          revalidateReason: undefined,\n        },\n        silenceLog\n      )\n\n      const errResult = await errRouteModule.render(\n        // @ts-expect-error we don't type this for edge\n        baseReq,\n        new WebNextResponse(undefined),\n        {\n          ...renderContext,\n          page: error500Mod ? '/500' : '/_error',\n          renderOpts: {\n            ...renderContext.renderOpts,\n            getServerSideProps: errModule.getServerSideProps,\n            Component: errModule.default || errModule,\n            ComponentMod: errModule,\n            pageConfig: errModule.config,\n          },\n        }\n      )\n\n      return renderResultToResponse(errResult)\n    }\n  }\n\n  const tracer = getTracer()\n\n  return tracer.withPropagatedContext(req.headers, () =>\n    tracer.trace(\n      BaseServerSpan.handleRequest,\n      {\n        spanName: `${req.method} ${srcPage}`,\n        kind: SpanKind.SERVER,\n        attributes: {\n          'http.method': req.method,\n          'http.target': relativeUrl,\n          'http.route': srcPage,\n        },\n      },\n      invokeRender\n    )\n  )\n}\n\nconst internalHandler: EdgeHandler = (opts) => {\n  return adapter({\n    ...opts,\n    IncrementalCache,\n    handler: requestHandler,\n    incrementalCacheHandler,\n    bypassNextUrl: true,\n    page: 'VAR_DEFINITION_PATHNAME',\n  })\n}\n\nexport async function handler(\n  request: Request,\n  ctx: {\n    waitUntil?: (prom: Promise<void>) => void\n    signal?: AbortSignal\n    requestMeta?: RequestMeta\n  }\n): Promise<Response> {\n  const result = await internalHandler({\n    request: {\n      url: request.url,\n      method: request.method,\n      headers: toNodeOutgoingHttpHeaders(request.headers),\n      nextConfig: {\n        basePath: process.env.__NEXT_BASE_PATH,\n        i18n: process.env.__NEXT_I18N_CONFIG as any,\n        trailingSlash: Boolean(process.env.__NEXT_TRAILING_SLASH),\n        experimental: {\n          cacheLife: process.env.__NEXT_CACHE_LIFE as any,\n          authInterrupts: Boolean(\n            process.env.__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS\n          ),\n          clientParamParsingOrigins: process.env\n            .__NEXT_CLIENT_PARAM_PARSING_ORIGINS as any,\n        },\n      },\n      page: {\n        name: 'VAR_DEFINITION_PATHNAME',\n      },\n      body:\n        request.method !== 'GET' && request.method !== 'HEAD'\n          ? (request.body ?? undefined)\n          : undefined,\n      waitUntil: ctx.waitUntil,\n      requestMeta: ctx.requestMeta,\n      signal: ctx.signal || new AbortController().signal,\n    },\n  })\n\n  ctx.waitUntil?.(result.waitUntil)\n\n  return result.response\n}\n\n// backwards compat\nexport default internalHandler\n"],"names":["adapter","IncrementalCache","initializeCacheHandlers","Document","appMod","userlandPage","userlandErrorPage","RouteModule","WebNextRequest","WebNextResponse","getTracer","SpanKind","BaseServerSpan","HTML_CONTENT_TYPE_HEADER","toNodeOutgoingHttpHeaders","pageMod","routeModule","pageRouteModuleOptions","components","App","default","userland","distDir","process","env","__NEXT_RELATIVE_DIST_DIR","relativeProjectDir","__NEXT_RELATIVE_PROJECT_DIR","errorMod","errorRouteModuleOptions","error500Mod","userland500Page","user500RouteModuleOptions","ComponentMod","requestHandler","req","_event","nextConfig","srcPage","relativeUrl","nextUrl","pathname","search","baseReq","pageRouteModule","prepareResult","prepare","multiZoneDraftMode","Response","status","query","params","buildId","deploymentId","isNextDataRequest","buildManifest","prerenderManifest","reactLoadableManifest","subresourceIntegrityManifest","dynamicCssManifest","cacheMaxMemorySize","renderContext","page","sharedContext","customServer","undefined","isFallback","isDraftMode","developmentNotFoundSourcePage","renderOpts","supportsDynamicResponse","Component","pageConfig","previewProps","preview","basePath","assetPrefix","images","optimizeCss","experimental","nextConfigOutput","output","nextScriptWorkers","disableOptimizedLoading","domainLocales","i18n","domains","crossOrigin","largePageDataBytes","isExperimentalCompile","clientTraceMetadata","finalStatus","renderResultToResponse","result","isNull","metadata","statusCode","headers","Headers","contentType","set","key","value","Object","entries","Array","isArray","v","append","String","isDynamic","body","toUnchunkedString","TextEncoder","encode","length","readable","writable","TransformStream","pipeTo","catch","err","console","error","invokeRender","span","render","getServerSideProps","config","finally","setAttributes","rootSpanAttributes","tracer","getRootSpanAttributes","get","handleRequest","warn","route","name","method","updateName","errModule","errRouteModule","isDev","silenceLog","onRequestError","routerKind","routePath","routeType","revalidateReason","errResult","withPropagatedContext","trace","spanName","kind","SERVER","attributes","internalHandler","opts","handler","incrementalCacheHandler","bypassNextUrl","request","ctx","url","__NEXT_BASE_PATH","__NEXT_I18N_CONFIG","trailingSlash","Boolean","__NEXT_TRAILING_SLASH","cacheLife","__NEXT_CACHE_LIFE","authInterrupts","__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS","clientParamParsingOrigins","__NEXT_CLIENT_PARAM_PARSING_ORIGINS","waitUntil","requestMeta","signal","AbortController","response"],"mappings":"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","ignoreList":[0]}