{"version":3,"sources":["../../../../src/build/templates/pages-edge-api.ts"],"sourcesContent":["import type { EdgeHandler } from '../../server/web/adapter'\n\nimport '../../server/web/globals'\n\nimport { adapter } from '../../server/web/adapter'\nimport { IncrementalCache } from '../../server/lib/incremental-cache'\nimport { wrapApiHandler } from '../../server/api-utils'\n\n// Import the userland code.\nimport handlerUserland from 'VAR_USERLAND'\nimport { toNodeOutgoingHttpHeaders } from '../../server/web/utils'\nimport type { RequestMeta } from '../../server/request-meta'\n\nconst page = 'VAR_DEFINITION_PAGE'\n\nif (typeof handlerUserland !== 'function') {\n  throw new Error(\n    `The Edge Function \"pages${page}\" must export a \\`default\\` function`\n  )\n}\n\nconst internalHandler: EdgeHandler = (opts) => {\n  return adapter({\n    ...opts,\n    IncrementalCache,\n    page: 'VAR_DEFINITION_PATHNAME',\n    handler: wrapApiHandler(page, handlerUserland),\n  })\n}\n\nexport async function handler(\n  request: Request,\n  ctx: {\n    waitUntil?: (prom: Promise<void>) => void\n    signal?: AbortSignal\n    requestMeta?: RequestMeta\n  }\n): Promise<Response> {\n  const result = await internalHandler({\n    request: {\n      url: request.url,\n      method: request.method,\n      headers: toNodeOutgoingHttpHeaders(request.headers),\n      nextConfig: {\n        basePath: process.env.__NEXT_BASE_PATH,\n        i18n: process.env.__NEXT_I18N_CONFIG as any,\n        trailingSlash: Boolean(process.env.__NEXT_TRAILING_SLASH),\n        experimental: {\n          cacheLife: process.env.__NEXT_CACHE_LIFE as any,\n          authInterrupts: Boolean(\n            process.env.__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS\n          ),\n          clientParamParsingOrigins: process.env\n            .__NEXT_CLIENT_PARAM_PARSING_ORIGINS as any,\n        },\n      },\n      page: {\n        name: 'VAR_DEFINITION_PATHNAME',\n      },\n      body:\n        request.method !== 'GET' && request.method !== 'HEAD'\n          ? (request.body ?? undefined)\n          : undefined,\n      waitUntil: ctx.waitUntil,\n      requestMeta: ctx.requestMeta,\n      signal: ctx.signal || new AbortController().signal,\n    },\n  })\n\n  ctx.waitUntil?.(result.waitUntil)\n\n  return result.response\n}\n\n// backwards compat\nexport default internalHandler\n"],"names":["adapter","IncrementalCache","wrapApiHandler","handlerUserland","toNodeOutgoingHttpHeaders","page","Error","internalHandler","opts","handler","request","ctx","result","url","method","headers","nextConfig","basePath","process","env","__NEXT_BASE_PATH","i18n","__NEXT_I18N_CONFIG","trailingSlash","Boolean","__NEXT_TRAILING_SLASH","experimental","cacheLife","__NEXT_CACHE_LIFE","authInterrupts","__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS","clientParamParsingOrigins","__NEXT_CLIENT_PARAM_PARSING_ORIGINS","name","body","undefined","waitUntil","requestMeta","signal","AbortController","response"],"mappings":"AAEA,OAAO,2BAA0B;AAEjC,SAASA,OAAO,QAAQ,2BAA0B;AAClD,SAASC,gBAAgB,QAAQ,qCAAoC;AACrE,SAASC,cAAc,QAAQ,yBAAwB;AAEvD,4BAA4B;AAC5B,OAAOC,qBAAqB,eAAc;AAC1C,SAASC,yBAAyB,QAAQ,yBAAwB;AAGlE,MAAMC,OAAO;AAEb,IAAI,OAAOF,oBAAoB,YAAY;IACzC,MAAM,qBAEL,CAFK,IAAIG,MACR,CAAC,wBAAwB,EAAED,KAAK,oCAAoC,CAAC,GADjE,qBAAA;eAAA;oBAAA;sBAAA;IAEN;AACF;AAEA,MAAME,kBAA+B,CAACC;IACpC,OAAOR,QAAQ;QACb,GAAGQ,IAAI;QACPP;QACAI,MAAM;QACNI,SAASP,eAAeG,MAAMF;IAChC;AACF;AAEA,OAAO,eAAeM,QACpBC,OAAgB,EAChBC,GAIC;IAED,MAAMC,SAAS,MAAML,gBAAgB;QACnCG,SAAS;YACPG,KAAKH,QAAQG,GAAG;YAChBC,QAAQJ,QAAQI,MAAM;YACtBC,SAASX,0BAA0BM,QAAQK,OAAO;YAClDC,YAAY;gBACVC,UAAUC,QAAQC,GAAG,CAACC,gBAAgB;gBACtCC,MAAMH,QAAQC,GAAG,CAACG,kBAAkB;gBACpCC,eAAeC,QAAQN,QAAQC,GAAG,CAACM,qBAAqB;gBACxDC,cAAc;oBACZC,WAAWT,QAAQC,GAAG,CAACS,iBAAiB;oBACxCC,gBAAgBL,QACdN,QAAQC,GAAG,CAACW,mCAAmC;oBAEjDC,2BAA2Bb,QAAQC,GAAG,CACnCa,mCAAmC;gBACxC;YACF;YACA3B,MAAM;gBACJ4B,MAAM;YACR;YACAC,MACExB,QAAQI,MAAM,KAAK,SAASJ,QAAQI,MAAM,KAAK,SAC1CJ,QAAQwB,IAAI,IAAIC,YACjBA;YACNC,WAAWzB,IAAIyB,SAAS;YACxBC,aAAa1B,IAAI0B,WAAW;YAC5BC,QAAQ3B,IAAI2B,MAAM,IAAI,IAAIC,kBAAkBD,MAAM;QACpD;IACF;IAEA3B,IAAIyB,SAAS,oBAAbzB,IAAIyB,SAAS,MAAbzB,KAAgBC,OAAOwB,SAAS;IAEhC,OAAOxB,OAAO4B,QAAQ;AACxB;AAEA,mBAAmB;AACnB,eAAejC,gBAAe","ignoreList":[0]}