{"version":3,"sources":["../../../../src/build/templates/edge-app-route.ts"],"sourcesContent":["import { setManifestsSingleton } from '../../server/app-render/manifests-singleton'\nimport type { RequestMeta } from '../../server/request-meta'\nimport type { EdgeHandler } from '../../server/web/adapter'\nimport { EdgeRouteModuleWrapper } from '../../server/web/edge-route-module-wrapper'\n\n// Import the userland code.\nimport * as module from 'VAR_USERLAND'\nimport { toNodeOutgoingHttpHeaders } from '../../server/web/utils'\n\n// injected by the loader afterwards.\n\nconst maybeJSONParse = (str?: string) => (str ? JSON.parse(str) : undefined)\n\nconst rscManifest = self.__RSC_MANIFEST?.['VAR_PAGE']\nconst rscServerManifest = maybeJSONParse(self.__RSC_SERVER_MANIFEST)\n\nif (rscManifest && rscServerManifest) {\n  setManifestsSingleton({\n    page: 'VAR_PAGE',\n    clientReferenceManifest: rscManifest,\n    serverActionsManifest: rscServerManifest,\n  })\n}\n\nexport const ComponentMod = module\n\nconst internalHandler: EdgeHandler = EdgeRouteModuleWrapper.wrap(\n  module.routeModule,\n  {\n    page: 'VAR_PAGE',\n  }\n)\n\nexport async function handler(\n  request: Request,\n  ctx: {\n    waitUntil?: (prom: Promise<void>) => void\n    signal?: AbortSignal\n    requestMeta?: RequestMeta\n  }\n): Promise<Response> {\n  const result = await internalHandler({\n    request: {\n      url: request.url,\n      method: request.method,\n      headers: toNodeOutgoingHttpHeaders(request.headers),\n      nextConfig: {\n        basePath: process.env.__NEXT_BASE_PATH,\n        i18n: process.env.__NEXT_I18N_CONFIG as any,\n        trailingSlash: Boolean(process.env.__NEXT_TRAILING_SLASH),\n        experimental: {\n          cacheLife: process.env.__NEXT_CACHE_LIFE as any,\n          authInterrupts: Boolean(\n            process.env.__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS\n          ),\n          clientParamParsingOrigins: process.env\n            .__NEXT_CLIENT_PARAM_PARSING_ORIGINS as any,\n        },\n      },\n      page: {\n        name: 'VAR_PAGE',\n      },\n      body:\n        request.method !== 'GET' && request.method !== 'HEAD'\n          ? (request.body ?? undefined)\n          : undefined,\n      waitUntil: ctx.waitUntil,\n      requestMeta: ctx.requestMeta,\n      signal: ctx.signal || new AbortController().signal,\n    },\n  })\n\n  ctx.waitUntil?.(result.waitUntil)\n\n  return result.response\n}\n\n// backwards compat\nexport default internalHandler\n"],"names":["self","setManifestsSingleton","EdgeRouteModuleWrapper","module","toNodeOutgoingHttpHeaders","maybeJSONParse","str","JSON","parse","undefined","rscManifest","__RSC_MANIFEST","rscServerManifest","__RSC_SERVER_MANIFEST","page","clientReferenceManifest","serverActionsManifest","ComponentMod","internalHandler","wrap","routeModule","handler","request","ctx","result","url","method","headers","nextConfig","basePath","process","env","__NEXT_BASE_PATH","i18n","__NEXT_I18N_CONFIG","trailingSlash","Boolean","__NEXT_TRAILING_SLASH","experimental","cacheLife","__NEXT_CACHE_LIFE","authInterrupts","__NEXT_EXPERIMENTAL_AUTH_INTERRUPTS","clientParamParsingOrigins","__NEXT_CLIENT_PARAM_PARSING_ORIGINS","name","body","waitUntil","requestMeta","signal","AbortController","response"],"mappings":"IAaoBA;AAbpB,SAASC,qBAAqB,QAAQ,8CAA6C;AAGnF,SAASC,sBAAsB,QAAQ,6CAA4C;AAEnF,4BAA4B;AAC5B,YAAYC,YAAY,eAAc;AACtC,SAASC,yBAAyB,QAAQ,yBAAwB;AAElE,qCAAqC;AAErC,MAAMC,iBAAiB,CAACC,MAAkBA,MAAMC,KAAKC,KAAK,CAACF,OAAOG;AAElE,MAAMC,eAAcV,uBAAAA,KAAKW,cAAc,qBAAnBX,oBAAqB,CAAC,WAAW;AACrD,MAAMY,oBAAoBP,eAAeL,KAAKa,qBAAqB;AAEnE,IAAIH,eAAeE,mBAAmB;IACpCX,sBAAsB;QACpBa,MAAM;QACNC,yBAAyBL;QACzBM,uBAAuBJ;IACzB;AACF;AAEA,OAAO,MAAMK,eAAed,OAAM;AAElC,MAAMe,kBAA+BhB,uBAAuBiB,IAAI,CAC9DhB,OAAOiB,WAAW,EAClB;IACEN,MAAM;AACR;AAGF,OAAO,eAAeO,QACpBC,OAAgB,EAChBC,GAIC;IAED,MAAMC,SAAS,MAAMN,gBAAgB;QACnCI,SAAS;YACPG,KAAKH,QAAQG,GAAG;YAChBC,QAAQJ,QAAQI,MAAM;YACtBC,SAASvB,0BAA0BkB,QAAQK,OAAO;YAClDC,YAAY;gBACVC,UAAUC,QAAQC,GAAG,CAACC,gBAAgB;gBACtCC,MAAMH,QAAQC,GAAG,CAACG,kBAAkB;gBACpCC,eAAeC,QAAQN,QAAQC,GAAG,CAACM,qBAAqB;gBACxDC,cAAc;oBACZC,WAAWT,QAAQC,GAAG,CAACS,iBAAiB;oBACxCC,gBAAgBL,QACdN,QAAQC,GAAG,CAACW,mCAAmC;oBAEjDC,2BAA2Bb,QAAQC,GAAG,CACnCa,mCAAmC;gBACxC;YACF;YACA9B,MAAM;gBACJ+B,MAAM;YACR;YACAC,MACExB,QAAQI,MAAM,KAAK,SAASJ,QAAQI,MAAM,KAAK,SAC1CJ,QAAQwB,IAAI,IAAIrC,YACjBA;YACNsC,WAAWxB,IAAIwB,SAAS;YACxBC,aAAazB,IAAIyB,WAAW;YAC5BC,QAAQ1B,IAAI0B,MAAM,IAAI,IAAIC,kBAAkBD,MAAM;QACpD;IACF;IAEA1B,IAAIwB,SAAS,oBAAbxB,IAAIwB,SAAS,MAAbxB,KAAgBC,OAAOuB,SAAS;IAEhC,OAAOvB,OAAO2B,QAAQ;AACxB;AAEA,mBAAmB;AACnB,eAAejC,gBAAe","ignoreList":[0]}