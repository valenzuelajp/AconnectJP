{"version":3,"sources":["../../../src/build/utils.ts"],"sourcesContent":["import type {\n  NextConfigComplete,\n  NextConfigRuntime,\n} from '../server/config-shared'\nimport type { ExperimentalPPRConfig } from '../server/lib/experimental/ppr'\nimport { checkIsRoutePPREnabled } from '../server/lib/experimental/ppr'\nimport type { AssetBinding } from './webpack/loaders/get-module-build-info'\nimport type { ServerRuntime } from '../types'\nimport type { BuildManifest } from '../server/get-page-files'\nimport {\n  normalizeRouteRegex,\n  type CustomRoutes,\n  type Header,\n  type Redirect,\n  type Rewrite,\n} from '../lib/load-custom-routes'\nimport type {\n  EdgeFunctionDefinition,\n  MiddlewareManifest,\n} from './webpack/plugins/middleware-plugin'\nimport type { WebpackLayerName } from '../lib/constants'\nimport {\n  INSTRUMENTATION_HOOK_FILENAME,\n  MIDDLEWARE_FILENAME,\n  SERVER_PROPS_GET_INIT_PROPS_CONFLICT,\n  SERVER_PROPS_SSG_CONFLICT,\n  SSG_GET_INITIAL_PROPS_CONFLICT,\n  WEBPACK_LAYERS,\n  PROXY_FILENAME,\n} from '../lib/constants'\nimport type {\n  AppPageModule,\n  AppPageRouteModule,\n} from '../server/route-modules/app-page/module'\nimport type { NextComponentType } from '../shared/lib/utils'\n\nimport '../server/require-hook'\nimport '../server/node-polyfill-crypto'\nimport '../server/node-environment'\n\nimport { bold, cyan, green, red, underline, yellow } from '../lib/picocolors'\nimport textTable from 'next/dist/compiled/text-table'\nimport path from 'path'\nimport { promises as fs } from 'fs'\nimport { isValidElementType } from 'next/dist/compiled/react-is'\nimport stripAnsi from 'next/dist/compiled/strip-ansi'\nimport browserslist from 'next/dist/compiled/browserslist'\nimport {\n  MODERN_BROWSERSLIST_TARGET,\n  UNDERSCORE_GLOBAL_ERROR_ROUTE,\n  UNDERSCORE_GLOBAL_ERROR_ROUTE_ENTRY,\n  UNDERSCORE_NOT_FOUND_ROUTE,\n} from '../shared/lib/constants'\nimport { isDynamicRoute } from '../shared/lib/router/utils/is-dynamic'\nimport { findPageFile } from '../server/lib/find-page-file'\nimport { isEdgeRuntime } from '../lib/is-edge-runtime'\nimport * as Log from './output/log'\nimport type { LoadComponentsReturnType } from '../server/load-components'\nimport { loadComponents } from '../server/load-components'\nimport { trace } from '../trace'\nimport { setHttpClientAndAgentOptions } from '../server/setup-http-agent-env'\nimport { Sema } from 'next/dist/compiled/async-sema'\nimport { normalizePagePath } from '../shared/lib/page-path/normalize-page-path'\nimport { getRuntimeContext } from '../server/web/sandbox'\nimport { RouteKind } from '../server/route-kind'\nimport type { PageExtensions } from './page-extensions-type'\nimport type { FallbackMode } from '../lib/fallback'\nimport type { OutgoingHttpHeaders } from 'http'\nimport type { AppSegmentConfig } from './segment-config/app/app-segment-config'\nimport type { AppSegment } from './segment-config/app/app-segments'\nimport { collectSegments } from './segment-config/app/app-segments'\nimport { createIncrementalCache } from '../export/helpers/create-incremental-cache'\nimport { collectRootParamKeys } from './segment-config/app/collect-root-param-keys'\nimport { buildAppStaticPaths } from './static-paths/app'\nimport { buildPagesStaticPaths } from './static-paths/pages'\nimport type { PrerenderedRoute } from './static-paths/types'\nimport type { CacheControl } from '../server/lib/cache-control'\nimport { formatExpire, formatRevalidate } from './output/format'\nimport type {\n  AppRouteModule,\n  AppRouteRouteModule,\n} from '../server/route-modules/app-route/module'\nimport { formatIssue, isRelevantWarning } from '../shared/lib/turbopack/utils'\nimport type { TurbopackResult } from './swc/types'\nimport type { FunctionsConfigManifest, ManifestRoute } from './index'\nimport { getNamedRouteRegex } from '../shared/lib/router/utils/route-regex'\nimport { parseAppRoute } from '../shared/lib/router/routes/app'\nimport { fillMetadataSegment } from '../lib/metadata/get-metadata-route'\nimport { STATIC_METADATA_IMAGES } from '../lib/metadata/is-metadata-route'\n\n// Build a set of static metadata image filenames for quick lookup\nconst staticMetadataImageFilenames = new Set<string>(\n  Object.values(STATIC_METADATA_IMAGES).map((meta) => meta.filename)\n)\n\n/**\n * Get the display path for build output. For static metadata files under\n * dynamic routes, this normalizes the path to use \"-\" placeholder.\n * e.g., /dynamic/[id]/icon.png -> /dynamic/-/icon.png\n */\nfunction getTreeViewDisplayPath(pagePath: string): string {\n  // Check if the path contains dynamic segments\n  if (!isDynamicRoute(pagePath)) {\n    return pagePath\n  }\n\n  // Check if the filename is a static metadata image\n  const lastSlash = pagePath.lastIndexOf('/')\n  const filename = pagePath.slice(lastSlash + 1)\n  const dotIndex = filename.lastIndexOf('.')\n  const baseName = dotIndex > 0 ? filename.slice(0, dotIndex) : filename\n\n  // Check against known static metadata image filenames (e.g., icon, apple-icon, opengraph-image)\n  if (!staticMetadataImageFilenames.has(baseName)) {\n    return pagePath\n  }\n\n  // Transform using fillMetadataSegment with isStatic=true\n  const segment = pagePath.slice(0, lastSlash)\n  const lastSegment = filename\n  return fillMetadataSegment(segment, {}, lastSegment, true)\n}\n\nexport type ROUTER_TYPE = 'pages' | 'app'\n\nexport type DynamicManifestRoute = ManifestRoute & {\n  /**\n   * The source page that this route is based on. This is used to determine the\n   * source page for the route and is only relevant for app pages where PPR is\n   * enabled and the page differs from the source page.\n   */\n  sourcePage: string | undefined\n}\n\n// Use `print()` for expected console output\nconst print = console.log\n\nconst RESERVED_PAGE = /^\\/(_app|_error|_document|api(\\/|$))/\n\nexport function unique<T>(main: ReadonlyArray<T>, sub: ReadonlyArray<T>): T[] {\n  return [...new Set([...main, ...sub])]\n}\n\nexport function difference<T>(\n  main: ReadonlyArray<T> | ReadonlySet<T>,\n  sub: ReadonlyArray<T> | ReadonlySet<T>\n): T[] {\n  const a = new Set(main)\n  const b = new Set(sub)\n  return [...a].filter((x) => !b.has(x))\n}\n\nexport function isMiddlewareFilename(file?: string | null) {\n  return (\n    file === MIDDLEWARE_FILENAME ||\n    file === `src/${MIDDLEWARE_FILENAME}` ||\n    file === PROXY_FILENAME ||\n    file === `src/${PROXY_FILENAME}`\n  )\n}\n\nexport function isInstrumentationHookFilename(file?: string | null) {\n  return (\n    file === INSTRUMENTATION_HOOK_FILENAME ||\n    file === `src/${INSTRUMENTATION_HOOK_FILENAME}`\n  )\n}\n\nconst filterAndSortList = (\n  list: ReadonlyArray<string>,\n  routeType: ROUTER_TYPE,\n  hasCustomApp: boolean\n) => {\n  let pages: string[]\n  if (routeType === 'app') {\n    // filter out static app route of /favicon.ico and /_global-error\n    pages = list.filter((e) => {\n      if (e === '/favicon.ico') return false\n      // Hide static /_global-error from build output\n      if (e === '/_global-error') return false\n      return true\n    })\n  } else {\n    // filter built-in pages\n    pages = list\n      .slice()\n      .filter(\n        (e) =>\n          !(\n            e === '/_document' ||\n            e === '/_error' ||\n            (!hasCustomApp && e === '/_app')\n          )\n      )\n  }\n  return pages.sort((a, b) => a.localeCompare(b))\n}\n\nexport interface PageInfo {\n  originalAppPath: string | undefined\n  isStatic: boolean\n  isSSG: boolean\n  /**\n   * If true, it means that the route has partial prerendering enabled.\n   */\n  isRoutePPREnabled: boolean\n  ssgPageRoutes: string[] | null\n  initialCacheControl: CacheControl | undefined\n  pageDuration: number | undefined\n  ssgPageDurations: number[] | undefined\n  runtime: ServerRuntime\n  hasEmptyStaticShell?: boolean\n  hasPostponed?: boolean\n  isDynamicAppRoute?: boolean\n}\n\nexport type PageInfos = Map<string, PageInfo>\n\nexport interface RoutesUsingEdgeRuntime {\n  [route: string]: 0\n}\n\nexport function collectRoutesUsingEdgeRuntime(\n  input: PageInfos\n): RoutesUsingEdgeRuntime {\n  const routesUsingEdgeRuntime: RoutesUsingEdgeRuntime = {}\n  for (const [route, info] of input.entries()) {\n    if (isEdgeRuntime(info.runtime)) {\n      routesUsingEdgeRuntime[route] = 0\n    }\n  }\n\n  return routesUsingEdgeRuntime\n}\n\n/**\n * Processes and categorizes build issues, then logs them as warnings, errors, or fatal errors.\n * Stops execution if fatal issues are encountered.\n *\n * @param entrypoints - The result object containing build issues to process.\n * @param isDev - A flag indicating if the build is running in development mode.\n * @return This function does not return a value but logs or throws errors based on the issues.\n * @throws {Error} If a fatal issue is encountered, this function throws an error. In development mode, we only throw on\n *                 'fatal' and 'bug' issues. In production mode, we also throw on 'error' issues.\n */\nexport function printBuildErrors(\n  entrypoints: TurbopackResult,\n  isDev: boolean\n): void {\n  // Issues that we want to stop the server from executing\n  const topLevelFatalIssues = []\n  // Issues that are true errors, but we believe we can keep running and allow the user to address the issue\n  const topLevelErrors = []\n  // Issues that are warnings but should not affect the running of the build\n  const topLevelWarnings = []\n\n  // Track seen formatted error messages to avoid duplicates\n  const seenFatalIssues = new Set<string>()\n  const seenErrors = new Set<string>()\n  const seenWarnings = new Set<string>()\n\n  for (const issue of entrypoints.issues) {\n    // We only want to completely shut down the server\n    if (issue.severity === 'fatal' || issue.severity === 'bug') {\n      const formatted = formatIssue(issue)\n      if (!seenFatalIssues.has(formatted)) {\n        seenFatalIssues.add(formatted)\n        topLevelFatalIssues.push(formatted)\n      }\n    } else if (isRelevantWarning(issue)) {\n      const formatted = formatIssue(issue)\n      if (!seenWarnings.has(formatted)) {\n        seenWarnings.add(formatted)\n        topLevelWarnings.push(formatted)\n      }\n    } else if (issue.severity === 'error') {\n      const formatted = formatIssue(issue)\n      if (isDev) {\n        // We want to treat errors as recoverable in development\n        // so that we can show the errors in the site and allow users\n        // to respond to the errors when necessary. In production builds\n        // though we want to error out and stop the build process.\n        if (!seenErrors.has(formatted)) {\n          seenErrors.add(formatted)\n          topLevelErrors.push(formatted)\n        }\n      } else {\n        if (!seenFatalIssues.has(formatted)) {\n          seenFatalIssues.add(formatted)\n          topLevelFatalIssues.push(formatted)\n        }\n      }\n    }\n  }\n  // TODO: print in order by source location so issues from the same file are displayed together and then add a summary at the end about the number of warnings/errors\n  if (topLevelWarnings.length > 0) {\n    console.warn(\n      `Turbopack build encountered ${\n        topLevelWarnings.length\n      } warnings:\\n${topLevelWarnings.join('\\n')}`\n    )\n  }\n\n  if (topLevelErrors.length > 0) {\n    console.error(\n      `Turbopack build encountered ${\n        topLevelErrors.length\n      } errors:\\n${topLevelErrors.join('\\n')}`\n    )\n  }\n\n  if (topLevelFatalIssues.length > 0) {\n    throw new Error(\n      `Turbopack build failed with ${\n        topLevelFatalIssues.length\n      } errors:\\n${topLevelFatalIssues.join('\\n')}`\n    )\n  }\n}\n\nexport async function printTreeView(\n  lists: {\n    pages: ReadonlyArray<string>\n    app: ReadonlyArray<string> | undefined\n  },\n  pageInfos: Map<string, PageInfo>,\n  {\n    pagesDir,\n    pageExtensions,\n    middlewareManifest,\n    functionsConfigManifest,\n    useStaticPages404,\n    hasGSPAndRevalidateZero,\n  }: {\n    pagesDir?: string\n    pageExtensions: PageExtensions\n    buildManifest: BuildManifest\n    middlewareManifest: MiddlewareManifest\n    functionsConfigManifest: FunctionsConfigManifest\n    useStaticPages404: boolean\n    hasGSPAndRevalidateZero: Set<string>\n  }\n) {\n  // Can be overridden for test purposes to omit the build duration output.\n  const MIN_DURATION = process.env.__NEXT_PRIVATE_DETERMINISTIC_BUILD_OUTPUT\n    ? Infinity // Don't ever log build durations.\n    : 300\n\n  const getPrettyDuration = (_duration: number): string => {\n    const duration = `${_duration} ms`\n    // green for 300-1000ms\n    if (_duration < 1000) return green(duration)\n    // yellow for 1000-2000ms\n    if (_duration < 2000) return yellow(duration)\n    // red for >= 2000ms\n    return red(bold(duration))\n  }\n\n  // Check if we have a custom app.\n  const hasCustomApp = !!(\n    pagesDir && (await findPageFile(pagesDir, '/_app', pageExtensions, false))\n  )\n\n  // Collect all the symbols we use so we can print the icons out.\n  const usedSymbols = new Set()\n\n  const messages: string[][] = []\n\n  const printFileTree = async ({\n    list,\n    routerType,\n  }: {\n    list: ReadonlyArray<string>\n    routerType: ROUTER_TYPE\n  }) => {\n    const filteredPages = filterAndSortList(list, routerType, hasCustomApp)\n    if (filteredPages.length === 0) {\n      return\n    }\n\n    let showRevalidate = false\n    let showExpire = false\n\n    for (const page of filteredPages) {\n      const cacheControl = pageInfos.get(page)?.initialCacheControl\n\n      if (cacheControl?.revalidate) {\n        showRevalidate = true\n      }\n\n      if (cacheControl?.expire) {\n        showExpire = true\n      }\n\n      if (showRevalidate && showExpire) {\n        break\n      }\n    }\n\n    messages.push(\n      [\n        routerType === 'app' ? 'Route (app)' : 'Route (pages)',\n        showRevalidate ? 'Revalidate' : '',\n        showExpire ? 'Expire' : '',\n      ]\n        .filter((entry) => entry !== '')\n        .map((entry) => underline(entry))\n    )\n\n    filteredPages.forEach((item, i, arr) => {\n      const border =\n        i === 0\n          ? arr.length === 1\n            ? '─'\n            : '┌'\n          : i === arr.length - 1\n            ? '└'\n            : '├'\n\n      const pageInfo = pageInfos.get(item)\n      const totalDuration =\n        (pageInfo?.pageDuration || 0) +\n        (pageInfo?.ssgPageDurations?.reduce((a, b) => a + (b || 0), 0) || 0)\n\n      let symbol: string\n\n      if (item === '/_app' || item === '/_app.server') {\n        symbol = ' '\n      } else if (isEdgeRuntime(pageInfo?.runtime)) {\n        symbol = 'ƒ'\n      } else if (pageInfo?.isRoutePPREnabled) {\n        if (\n          // If the page has an empty static shell, then it's equivalent to a\n          // dynamic page\n          pageInfo?.hasEmptyStaticShell ||\n          // ensure we don't mark dynamic paths that postponed as being dynamic\n          // since in this case we're able to partially prerender it\n          (pageInfo.isDynamicAppRoute && !pageInfo.hasPostponed)\n        ) {\n          symbol = 'ƒ'\n        } else if (!pageInfo?.hasPostponed) {\n          symbol = '○'\n        } else {\n          symbol = '◐'\n        }\n      } else if (pageInfo?.isStatic) {\n        symbol = '○'\n      } else if (pageInfo?.isSSG) {\n        symbol = '●'\n      } else {\n        symbol = 'ƒ'\n      }\n\n      const displayPath = getTreeViewDisplayPath(item)\n\n      if (hasGSPAndRevalidateZero.has(item)) {\n        usedSymbols.add('ƒ')\n        messages.push([\n          `${border} ƒ ${displayPath}${\n            totalDuration > MIN_DURATION\n              ? ` (${getPrettyDuration(totalDuration)})`\n              : ''\n          }`,\n          showRevalidate && pageInfo?.initialCacheControl\n            ? formatRevalidate(pageInfo.initialCacheControl)\n            : '',\n          showExpire && pageInfo?.initialCacheControl\n            ? formatExpire(pageInfo.initialCacheControl)\n            : '',\n        ])\n      }\n\n      usedSymbols.add(symbol)\n\n      messages.push([\n        `${border} ${symbol} ${displayPath}${\n          totalDuration > MIN_DURATION\n            ? ` (${getPrettyDuration(totalDuration)})`\n            : ''\n        }`,\n        showRevalidate && pageInfo?.initialCacheControl\n          ? formatRevalidate(pageInfo.initialCacheControl)\n          : '',\n        showExpire && pageInfo?.initialCacheControl\n          ? formatExpire(pageInfo.initialCacheControl)\n          : '',\n      ])\n\n      if (pageInfo?.ssgPageRoutes?.length) {\n        const totalRoutes = pageInfo.ssgPageRoutes.length\n        const contSymbol = i === arr.length - 1 ? ' ' : '│'\n\n        // HERE\n\n        let routes: { route: string; duration: number; avgDuration?: number }[]\n        if (pageInfo.ssgPageDurations?.some((d) => d > MIN_DURATION)) {\n          const previewPages = totalRoutes === 8 ? 8 : Math.min(totalRoutes, 7)\n          const routesWithDuration = pageInfo.ssgPageRoutes\n            .map((route, idx) => ({\n              route,\n              duration: pageInfo.ssgPageDurations![idx] || 0,\n            }))\n            .sort(({ duration: a }, { duration: b }) =>\n              // Sort by duration\n              // keep too small durations in original order at the end\n              a <= MIN_DURATION && b <= MIN_DURATION ? 0 : b - a\n            )\n          routes = routesWithDuration.slice(0, previewPages)\n          const remainingRoutes = routesWithDuration.slice(previewPages)\n          if (remainingRoutes.length) {\n            const remaining = remainingRoutes.length\n            const avgDuration = Math.round(\n              remainingRoutes.reduce(\n                (total, { duration }) => total + duration,\n                0\n              ) / remainingRoutes.length\n            )\n            routes.push({\n              route: `[+${remaining} more paths]`,\n              duration: 0,\n              avgDuration,\n            })\n          }\n        } else {\n          const previewPages = totalRoutes === 4 ? 4 : Math.min(totalRoutes, 3)\n          routes = pageInfo.ssgPageRoutes\n            .slice(0, previewPages)\n            .map((route) => ({ route, duration: 0 }))\n          if (totalRoutes > previewPages) {\n            const remaining = totalRoutes - previewPages\n            routes.push({ route: `[+${remaining} more paths]`, duration: 0 })\n          }\n        }\n\n        routes.forEach(\n          ({ route, duration, avgDuration }, index, { length }) => {\n            const innerSymbol = index === length - 1 ? '└' : '├'\n\n            const initialCacheControl =\n              pageInfos.get(route)?.initialCacheControl\n\n            messages.push([\n              `${contSymbol} ${innerSymbol} ${route}${\n                duration > MIN_DURATION\n                  ? ` (${getPrettyDuration(duration)})`\n                  : ''\n              }${\n                avgDuration && avgDuration > MIN_DURATION\n                  ? ` (avg ${getPrettyDuration(avgDuration)})`\n                  : ''\n              }`,\n              showRevalidate && initialCacheControl\n                ? formatRevalidate(initialCacheControl)\n                : '',\n              showExpire && initialCacheControl\n                ? formatExpire(initialCacheControl)\n                : '',\n            ])\n          }\n        )\n      }\n    })\n  }\n\n  // If enabled, then print the tree for the app directory.\n  if (lists.app) {\n    await printFileTree({\n      routerType: 'app',\n      list: lists.app,\n    })\n\n    messages.push(['', '', '', ''])\n  }\n\n  pageInfos.set('/404', {\n    ...(pageInfos.get('/404') || pageInfos.get('/_error'))!,\n    isStatic: useStaticPages404,\n  })\n\n  // If there's no app /_notFound page present, then the 404 is still using the pages/404\n  if (\n    !lists.pages.includes('/404') &&\n    !lists.app?.includes(UNDERSCORE_NOT_FOUND_ROUTE)\n  ) {\n    lists.pages = [...lists.pages, '/404']\n  }\n\n  // Print the tree view for the pages directory.\n  await printFileTree({\n    routerType: 'pages',\n    list: lists.pages,\n  })\n\n  if (\n    middlewareManifest.middleware?.['/']?.files.length > 0 ||\n    // 'nodejs' runtime middleware or proxy is set to\n    // functions-config-manifest instead of middleware-manifest.\n    functionsConfigManifest.functions?.['/_middleware']\n  ) {\n    messages.push([])\n    messages.push(['ƒ Proxy (Middleware)'])\n  }\n\n  print(\n    textTable(messages, {\n      align: ['l', 'r', 'r', 'r'],\n      stringLength: (str) => stripAnsi(str).length,\n    })\n  )\n\n  const staticFunctionInfo = lists.app\n    ? 'generateStaticParams'\n    : 'getStaticProps'\n  print()\n  print(\n    textTable(\n      [\n        usedSymbols.has('○') && [\n          '○',\n          '(Static)',\n          'prerendered as static content',\n        ],\n        usedSymbols.has('●') && [\n          '●',\n          '(SSG)',\n          `prerendered as static HTML (uses ${cyan(staticFunctionInfo)})`,\n        ],\n        usedSymbols.has('◐') && [\n          '◐',\n          '(Partial Prerender)',\n          'prerendered as static HTML with dynamic server-streamed content',\n        ],\n        usedSymbols.has('ƒ') && ['ƒ', '(Dynamic)', `server-rendered on demand`],\n      ].filter((x) => x) as [string, string, string][],\n      {\n        align: ['l', 'l', 'l'],\n        stringLength: (str) => stripAnsi(str).length,\n      }\n    )\n  )\n\n  print()\n}\n\nexport function printCustomRoutes({\n  redirects,\n  rewrites,\n  headers,\n}: CustomRoutes) {\n  const printRoutes = (\n    routes: Redirect[] | Rewrite[] | Header[],\n    type: 'Redirects' | 'Rewrites' | 'Headers'\n  ) => {\n    const isRedirects = type === 'Redirects'\n    const isHeaders = type === 'Headers'\n    print(underline(type))\n\n    /*\n        ┌ source\n        ├ permanent/statusCode\n        └ destination\n     */\n    const routesStr = (routes as any[])\n      .map((route: { source: string }) => {\n        let routeStr = `┌ source: ${route.source}\\n`\n\n        if (!isHeaders) {\n          const r = route as Rewrite\n          routeStr += `${isRedirects ? '├' : '└'} destination: ${\n            r.destination\n          }\\n`\n        }\n        if (isRedirects) {\n          const r = route as Redirect\n          routeStr += `└ ${\n            r.statusCode\n              ? `status: ${r.statusCode}`\n              : `permanent: ${r.permanent}`\n          }\\n`\n        }\n\n        if (isHeaders) {\n          const r = route as Header\n          routeStr += `└ headers:\\n`\n\n          for (let i = 0; i < r.headers.length; i++) {\n            const header = r.headers[i]\n            const last = i === headers.length - 1\n\n            routeStr += `  ${last ? '└' : '├'} ${header.key}: ${header.value}\\n`\n          }\n        }\n\n        return routeStr\n      })\n      .join('\\n')\n\n    print(`${routesStr}\\n`)\n  }\n\n  print()\n  if (redirects.length) {\n    printRoutes(redirects, 'Redirects')\n  }\n  if (headers.length) {\n    printRoutes(headers, 'Headers')\n  }\n\n  const combinedRewrites = [\n    ...rewrites.beforeFiles,\n    ...rewrites.afterFiles,\n    ...rewrites.fallback,\n  ]\n  if (combinedRewrites.length) {\n    printRoutes(combinedRewrites, 'Rewrites')\n  }\n}\n\ntype PageIsStaticResult = {\n  isRoutePPREnabled?: boolean\n  isStatic?: boolean\n  hasServerProps?: boolean\n  hasStaticProps?: boolean\n  prerenderedRoutes: PrerenderedRoute[] | undefined\n  prerenderFallbackMode: FallbackMode | undefined\n  rootParamKeys: readonly string[] | undefined\n  isNextImageImported?: boolean\n  traceIncludes?: string[]\n  traceExcludes?: string[]\n  appConfig?: AppSegmentConfig\n}\n\nexport async function isPageStatic({\n  dir,\n  page,\n  distDir,\n  configFileName,\n  httpAgentOptions,\n  locales,\n  defaultLocale,\n  parentId,\n  pageRuntime,\n  edgeInfo,\n  pageType,\n  cacheComponents,\n  authInterrupts,\n  originalAppPath,\n  isrFlushToDisk,\n  cacheMaxMemorySize,\n  nextConfigOutput,\n  cacheHandler,\n  cacheHandlers,\n  cacheLifeProfiles,\n  pprConfig,\n  buildId,\n  sriEnabled,\n}: {\n  dir: string\n  page: string\n  distDir: string\n  cacheComponents: boolean\n  authInterrupts: boolean\n  configFileName: string\n  httpAgentOptions: NextConfigComplete['httpAgentOptions']\n  locales?: readonly string[]\n  defaultLocale?: string\n  parentId?: any\n  edgeInfo?: any\n  pageType?: 'pages' | 'app'\n  pageRuntime?: ServerRuntime\n  originalAppPath?: string\n  isrFlushToDisk?: boolean\n  cacheMaxMemorySize: number\n  cacheHandler?: string\n  cacheHandlers?: Record<string, string | undefined>\n  cacheLifeProfiles?: {\n    [profile: string]: import('../server/use-cache/cache-life').CacheLife\n  }\n  nextConfigOutput: 'standalone' | 'export' | undefined\n  pprConfig: ExperimentalPPRConfig | undefined\n  buildId: string\n  sriEnabled: boolean\n}): Promise<PageIsStaticResult> {\n  // Skip page data collection for synthetic _global-error routes\n  if (page === UNDERSCORE_GLOBAL_ERROR_ROUTE) {\n    return {\n      isStatic: true,\n      isRoutePPREnabled: false,\n      prerenderFallbackMode: undefined,\n      prerenderedRoutes: undefined,\n      rootParamKeys: undefined,\n      hasStaticProps: false,\n      hasServerProps: false,\n      isNextImageImported: false,\n      appConfig: {},\n    }\n  }\n\n  await createIncrementalCache({\n    cacheHandler,\n    cacheHandlers,\n    distDir,\n    dir,\n    flushToDisk: isrFlushToDisk,\n    cacheMaxMemorySize,\n  })\n\n  const isPageStaticSpan = trace('is-page-static-utils', parentId)\n  return isPageStaticSpan\n    .traceAsyncFn(async (): Promise<PageIsStaticResult> => {\n      setHttpClientAndAgentOptions({\n        httpAgentOptions,\n      })\n\n      let componentsResult: LoadComponentsReturnType\n      let prerenderedRoutes: PrerenderedRoute[] | undefined\n      let prerenderFallbackMode: FallbackMode | undefined\n      let appConfig: AppSegmentConfig = {}\n      let rootParamKeys: readonly string[] | undefined\n      const pathIsEdgeRuntime = isEdgeRuntime(pageRuntime)\n\n      if (pathIsEdgeRuntime) {\n        const runtime = await getRuntimeContext({\n          paths: edgeInfo.files.map((file: string) => path.join(distDir, file)),\n          edgeFunctionEntry: {\n            ...edgeInfo,\n            wasm: (edgeInfo.wasm ?? []).map((binding: AssetBinding) => ({\n              ...binding,\n              filePath: path.join(distDir, binding.filePath),\n            })),\n          },\n          name: edgeInfo.name,\n          useCache: true,\n          distDir,\n        })\n        const mod = (\n          await runtime.context._ENTRIES[`middleware_${edgeInfo.name}`]\n        ).ComponentMod\n\n        // This is not needed during require.\n        const buildManifest = {} as BuildManifest\n\n        componentsResult = {\n          Component: mod.default,\n          Document: mod.Document,\n          App: mod.App,\n          routeModule: mod.routeModule,\n          page,\n          ComponentMod: mod,\n          pageConfig: mod.config || {},\n          buildManifest,\n          reactLoadableManifest: {},\n          getServerSideProps: mod.getServerSideProps,\n          getStaticPaths: mod.getStaticPaths,\n          getStaticProps: mod.getStaticProps,\n        }\n      } else {\n        componentsResult = await loadComponents({\n          distDir,\n          page: originalAppPath || page,\n          isAppPath: pageType === 'app',\n          isDev: false,\n          sriEnabled,\n          needsManifestsForLegacyReasons: true,\n        })\n      }\n\n      const { Component, routeModule } = componentsResult\n\n      const Comp = Component as NextComponentType | undefined\n\n      let isRoutePPREnabled: boolean = false\n\n      if (pageType === 'app') {\n        // @ts-expect-error pageType is app, so we can assume AppPageModule | AppRouteModule\n        const ComponentMod: AppPageModule | AppRouteModule =\n          componentsResult.ComponentMod\n\n        let segments: AppSegment[]\n        try {\n          segments = await collectSegments(\n            // We know this is an app page or app route module because we\n            // checked above that the page type is 'app'.\n            routeModule as AppPageRouteModule | AppRouteRouteModule\n          )\n        } catch (err) {\n          throw new Error(`Failed to collect configuration for ${page}`, {\n            cause: err,\n          })\n        }\n\n        appConfig =\n          originalAppPath === UNDERSCORE_GLOBAL_ERROR_ROUTE_ENTRY\n            ? {}\n            : reduceAppConfig(segments)\n\n        if (appConfig.dynamic === 'force-static' && pathIsEdgeRuntime) {\n          Log.warn(\n            `Page \"${page}\" is using runtime = 'edge' which is currently incompatible with dynamic = 'force-static'. Please remove either \"runtime\" or \"force-static\" for correct behavior`\n          )\n        }\n\n        rootParamKeys = collectRootParamKeys(routeModule)\n\n        // A page supports partial prerendering if it is an app page and either\n        // the whole app has PPR enabled or this page has PPR enabled when we're\n        // in incremental mode.\n        isRoutePPREnabled =\n          routeModule.definition.kind === RouteKind.APP_PAGE &&\n          checkIsRoutePPREnabled(pprConfig)\n\n        // If force dynamic was set and we don't have PPR enabled, then set the\n        // revalidate to 0.\n        // TODO: (PPR) remove this once PPR is enabled by default\n        if (appConfig.dynamic === 'force-dynamic' && !isRoutePPREnabled) {\n          appConfig.revalidate = 0\n        }\n\n        const route = parseAppRoute(page, true)\n\n        // If the page is dynamic and we're not in edge runtime, then we need to\n        // build the static paths. The edge runtime doesn't support static\n        // paths.\n        if (route.dynamicSegments.length > 0 && !pathIsEdgeRuntime) {\n          ;({ prerenderedRoutes, fallbackMode: prerenderFallbackMode } =\n            await buildAppStaticPaths({\n              dir,\n              page,\n              route,\n              cacheComponents,\n              authInterrupts,\n              segments,\n              distDir,\n              requestHeaders: {},\n              isrFlushToDisk,\n              cacheMaxMemorySize,\n              cacheHandler,\n              cacheLifeProfiles,\n              ComponentMod,\n              nextConfigOutput,\n              isRoutePPREnabled,\n              buildId,\n              rootParamKeys,\n            }))\n        }\n      } else {\n        if (!Comp || !isValidElementType(Comp) || typeof Comp === 'string') {\n          throw new Error('INVALID_DEFAULT_EXPORT')\n        }\n      }\n\n      const hasGetInitialProps = !!Comp?.getInitialProps\n      const hasStaticProps = !!componentsResult.getStaticProps\n      const hasStaticPaths = !!componentsResult.getStaticPaths\n      const hasServerProps = !!componentsResult.getServerSideProps\n\n      // A page cannot be prerendered _and_ define a data requirement. That's\n      // contradictory!\n      if (hasGetInitialProps && hasStaticProps) {\n        throw new Error(SSG_GET_INITIAL_PROPS_CONFLICT)\n      }\n\n      if (hasGetInitialProps && hasServerProps) {\n        throw new Error(SERVER_PROPS_GET_INIT_PROPS_CONFLICT)\n      }\n\n      if (hasStaticProps && hasServerProps) {\n        throw new Error(SERVER_PROPS_SSG_CONFLICT)\n      }\n\n      const pageIsDynamic = isDynamicRoute(page)\n      // A page cannot have static parameters if it is not a dynamic page.\n      if (hasStaticProps && hasStaticPaths && !pageIsDynamic) {\n        throw new Error(\n          `getStaticPaths can only be used with dynamic pages, not '${page}'.` +\n            `\\nLearn more: https://nextjs.org/docs/routing/dynamic-routes`\n        )\n      }\n\n      if (hasStaticProps && pageIsDynamic && !hasStaticPaths) {\n        throw new Error(\n          `getStaticPaths is required for dynamic SSG pages and is missing for '${page}'.` +\n            `\\nRead more: https://nextjs.org/docs/messages/invalid-getstaticpaths-value`\n        )\n      }\n\n      if (hasStaticProps && hasStaticPaths) {\n        ;({ prerenderedRoutes, fallbackMode: prerenderFallbackMode } =\n          await buildPagesStaticPaths({\n            page,\n            locales,\n            defaultLocale,\n            configFileName,\n            getStaticPaths: componentsResult.getStaticPaths!,\n          }))\n      }\n\n      const isNextImageImported = (globalThis as any).__NEXT_IMAGE_IMPORTED\n\n      let isStatic = false\n      if (!hasStaticProps && !hasGetInitialProps && !hasServerProps) {\n        isStatic = true\n      }\n\n      // When PPR is enabled, any route may be completely static, so\n      // mark this route as static.\n      if (isRoutePPREnabled) {\n        isStatic = true\n      }\n\n      return {\n        isStatic,\n        isRoutePPREnabled,\n        prerenderFallbackMode,\n        prerenderedRoutes,\n        rootParamKeys,\n        hasStaticProps,\n        hasServerProps,\n        isNextImageImported,\n        appConfig,\n      }\n    })\n    .catch((err) => {\n      if (err.message === 'INVALID_DEFAULT_EXPORT') {\n        throw err\n      }\n      console.error(err)\n      throw new Error(`Failed to collect page data for ${page}`)\n    })\n}\n\ntype ReducedAppConfig = Pick<\n  AppSegmentConfig,\n  | 'revalidate'\n  | 'dynamic'\n  | 'fetchCache'\n  | 'preferredRegion'\n  | 'runtime'\n  | 'maxDuration'\n>\n\n/**\n * Collect the app config from the generate param segments. This only gets a\n * subset of the config options.\n *\n * @param segments the generate param segments\n * @returns the reduced app config\n */\nexport function reduceAppConfig(\n  segments: Pick<AppSegment, 'config'>[]\n): ReducedAppConfig {\n  const config: ReducedAppConfig = {}\n\n  for (const segment of segments) {\n    const {\n      dynamic,\n      fetchCache,\n      preferredRegion,\n      revalidate,\n      runtime,\n      maxDuration,\n    } = segment.config || {}\n\n    // TODO: should conflicting configs here throw an error\n    // e.g. if layout defines one region but page defines another\n\n    if (typeof preferredRegion !== 'undefined') {\n      config.preferredRegion = preferredRegion\n    }\n\n    if (typeof dynamic !== 'undefined') {\n      config.dynamic = dynamic\n    }\n\n    if (typeof fetchCache !== 'undefined') {\n      config.fetchCache = fetchCache\n    }\n\n    if (typeof revalidate !== 'undefined') {\n      config.revalidate = revalidate\n    }\n\n    // Any revalidate number overrides false, and shorter revalidate overrides\n    // longer (initially).\n    if (\n      typeof revalidate === 'number' &&\n      (typeof config.revalidate !== 'number' || revalidate < config.revalidate)\n    ) {\n      config.revalidate = revalidate\n    }\n\n    if (typeof runtime !== 'undefined') {\n      config.runtime = runtime\n    }\n\n    if (typeof maxDuration !== 'undefined') {\n      config.maxDuration = maxDuration\n    }\n  }\n\n  return config\n}\n\nexport async function hasCustomGetInitialProps({\n  page,\n  distDir,\n  checkingApp,\n  sriEnabled,\n}: {\n  page: string\n  distDir: string\n  checkingApp: boolean\n  sriEnabled: boolean\n}): Promise<boolean> {\n  const { ComponentMod } = await loadComponents({\n    distDir,\n    page: page,\n    isAppPath: false,\n    isDev: false,\n    sriEnabled,\n    needsManifestsForLegacyReasons: true,\n  })\n  let mod = ComponentMod\n\n  if (checkingApp) {\n    // @ts-expect-error very dynamic code\n    mod = (await mod._app) || mod.default || mod\n  } else {\n    // @ts-expect-error very dynamic code\n    mod = mod.default || mod\n  }\n  mod = await mod\n  // @ts-expect-error very dynamic code\n  return mod.getInitialProps !== mod.origGetInitialProps\n}\n\nexport async function getDefinedNamedExports({\n  page,\n  distDir,\n  sriEnabled,\n}: {\n  page: string\n  distDir: string\n  sriEnabled: boolean\n}): Promise<ReadonlyArray<string>> {\n  const { ComponentMod } = await loadComponents({\n    distDir,\n    page: page,\n    isAppPath: false,\n    isDev: false,\n    sriEnabled,\n    needsManifestsForLegacyReasons: true,\n  })\n\n  return Object.keys(ComponentMod).filter((key) => {\n    return typeof ComponentMod[key as keyof typeof ComponentMod] !== 'undefined'\n  })\n}\n\nexport function detectConflictingPaths(\n  combinedPages: string[],\n  ssgPages: Set<string>,\n  additionalGeneratedSSGPaths: Map<string, string[]>\n) {\n  const conflictingPaths = new Map<\n    string,\n    Array<{\n      path: string\n      page: string\n    }>\n  >()\n\n  const dynamicSsgPages = [...ssgPages].filter((page) => isDynamicRoute(page))\n  const additionalSsgPathsByPath: {\n    [page: string]: { [path: string]: string }\n  } = {}\n\n  additionalGeneratedSSGPaths.forEach((paths, pathsPage) => {\n    additionalSsgPathsByPath[pathsPage] ||= {}\n    paths.forEach((curPath) => {\n      const currentPath = curPath.toLowerCase()\n      additionalSsgPathsByPath[pathsPage][currentPath] = curPath\n    })\n  })\n\n  additionalGeneratedSSGPaths.forEach((paths, pathsPage) => {\n    paths.forEach((curPath) => {\n      const lowerPath = curPath.toLowerCase()\n      let conflictingPage = combinedPages.find(\n        (page) => page.toLowerCase() === lowerPath\n      )\n\n      if (conflictingPage) {\n        conflictingPaths.set(lowerPath, [\n          { path: curPath, page: pathsPage },\n          { path: conflictingPage, page: conflictingPage },\n        ])\n      } else {\n        let conflictingPath: string | undefined\n\n        conflictingPage = dynamicSsgPages.find((page) => {\n          if (page === pathsPage) return false\n\n          conflictingPath =\n            additionalGeneratedSSGPaths.get(page) == null\n              ? undefined\n              : additionalSsgPathsByPath[page][lowerPath]\n          return conflictingPath\n        })\n\n        if (conflictingPage && conflictingPath) {\n          conflictingPaths.set(lowerPath, [\n            { path: curPath, page: pathsPage },\n            { path: conflictingPath, page: conflictingPage },\n          ])\n        }\n      }\n    })\n  })\n\n  if (conflictingPaths.size > 0) {\n    let conflictingPathsOutput = ''\n\n    conflictingPaths.forEach((pathItems) => {\n      pathItems.forEach((pathItem, idx) => {\n        const isDynamic = pathItem.page !== pathItem.path\n\n        if (idx > 0) {\n          conflictingPathsOutput += 'conflicts with '\n        }\n\n        conflictingPathsOutput += `path: \"${pathItem.path}\"${\n          isDynamic ? ` from page: \"${pathItem.page}\" ` : ' '\n        }`\n      })\n      conflictingPathsOutput += '\\n'\n    })\n\n    Log.error(\n      'Conflicting paths returned from getStaticPaths, paths must be unique per page.\\n' +\n        'See more info here: https://nextjs.org/docs/messages/conflicting-ssg-paths\\n\\n' +\n        conflictingPathsOutput\n    )\n    process.exit(1)\n  }\n}\n\nexport async function copyTracedFiles(\n  dir: string,\n  distDir: string,\n  pageKeys: readonly string[],\n  appPageKeys: readonly string[] | undefined,\n  tracingRoot: string,\n  serverConfig: NextConfigRuntime,\n  middlewareManifest: MiddlewareManifest,\n  hasNodeMiddleware: boolean,\n  hasInstrumentationHook: boolean,\n  staticPages: Set<string>\n) {\n  const outputPath = path.join(distDir, 'standalone')\n\n  // Clean up standalone directory first.\n  await fs.rm(outputPath, { recursive: true, force: true })\n\n  let moduleType = false\n  const nextConfig = {\n    ...serverConfig,\n    distDir: `./${path.relative(dir, distDir)}`,\n  }\n  try {\n    const packageJsonPath = path.join(distDir, '../package.json')\n    const packageJsonContent = await fs.readFile(\n      /* turbopackIgnore: true */ packageJsonPath,\n      'utf8'\n    )\n    const packageJson = JSON.parse(packageJsonContent)\n    moduleType = packageJson.type === 'module'\n\n    // we always copy the package.json to the standalone\n    // folder to ensure any resolving logic is maintained\n    const packageJsonOutputPath = path.join(\n      outputPath,\n      path.relative(tracingRoot, dir),\n      'package.json'\n    )\n    await fs.mkdir(path.dirname(packageJsonOutputPath), { recursive: true })\n    await fs.writeFile(packageJsonOutputPath, packageJsonContent)\n  } catch {}\n  const copiedFiles = new Set()\n\n  async function handleTraceFiles(traceFilePath: string) {\n    const traceData = JSON.parse(\n      await fs.readFile(/* turbopackIgnore: true */ traceFilePath, 'utf8')\n    ) as {\n      files: string[]\n    }\n    const copySema = new Sema(10, { capacity: traceData.files.length })\n    const traceFileDir = path.dirname(traceFilePath)\n\n    await Promise.all(\n      traceData.files.map(async (relativeFile) => {\n        await copySema.acquire()\n\n        const tracedFilePath = path.join(traceFileDir, relativeFile)\n        const fileOutputPath = path.join(\n          outputPath,\n          path.relative(tracingRoot, tracedFilePath)\n        )\n\n        if (!copiedFiles.has(fileOutputPath)) {\n          copiedFiles.add(fileOutputPath)\n\n          await fs.mkdir(path.dirname(fileOutputPath), { recursive: true })\n          const symlink = await fs.readlink(tracedFilePath).catch(() => null)\n\n          if (symlink) {\n            try {\n              await fs.symlink(symlink, fileOutputPath)\n            } catch (err: any) {\n              // Windows doesn't support creating symlinks without elevated privileges, unless\n              // \"Developer Mode\" is turned on. If we failed to create a symlink due to EPERM, try\n              // creating a junction point instead.\n              //\n              // Ideally we'd just preserve the input file type (junction point or symlink), but\n              // there's no API in node.js to differentiate between a junction point and a symlink,\n              // so we just try making a symlink first. Symlinks are preferred because they support\n              // relative paths and non-directory (file) targets.\n              if (\n                process.platform === 'win32' &&\n                err.code === 'EPERM' &&\n                path.isAbsolute(symlink)\n              ) {\n                try {\n                  await fs.symlink(symlink, fileOutputPath, 'junction')\n                } catch (junctionErr: any) {\n                  if (junctionErr.code !== 'EEXIST') {\n                    throw junctionErr\n                  }\n                }\n              } else if (err.code !== 'EEXIST') {\n                throw err\n              }\n            }\n          } else {\n            await fs.copyFile(tracedFilePath, fileOutputPath)\n          }\n        }\n\n        await copySema.release()\n      })\n    )\n  }\n\n  async function handleEdgeFunction(page: EdgeFunctionDefinition) {\n    async function handleFile(file: string) {\n      const originalPath = path.join(distDir, file)\n      const fileOutputPath = path.join(\n        outputPath,\n        path.relative(tracingRoot, distDir),\n        file\n      )\n      await fs.mkdir(path.dirname(fileOutputPath), { recursive: true })\n      await fs.copyFile(originalPath, fileOutputPath)\n    }\n    await Promise.all([\n      page.files.map(handleFile),\n      page.wasm?.map((file) => handleFile(file.filePath)),\n      page.assets?.map((file) => handleFile(file.filePath)),\n    ])\n  }\n\n  const edgeFunctionHandlers: Promise<any>[] = []\n\n  for (const middleware of Object.values(middlewareManifest.middleware)) {\n    if (isMiddlewareFilename(middleware.name)) {\n      edgeFunctionHandlers.push(handleEdgeFunction(middleware))\n    }\n  }\n\n  for (const page of Object.values(middlewareManifest.functions)) {\n    edgeFunctionHandlers.push(handleEdgeFunction(page))\n  }\n\n  await Promise.all(edgeFunctionHandlers)\n\n  for (const page of pageKeys) {\n    if (middlewareManifest.functions.hasOwnProperty(page)) {\n      continue\n    }\n    const route = normalizePagePath(page)\n\n    if (staticPages.has(route)) {\n      continue\n    }\n\n    const pageFile = path.join(\n      distDir,\n      'server',\n      'pages',\n      `${normalizePagePath(page)}.js`\n    )\n    const pageTraceFile = `${pageFile}.nft.json`\n    await handleTraceFiles(pageTraceFile).catch((err) => {\n      if (err.code !== 'ENOENT' || (page !== '/404' && page !== '/500')) {\n        Log.warn(`Failed to copy traced files for ${pageFile}`, err)\n      }\n    })\n  }\n\n  if (hasNodeMiddleware) {\n    const middlewareFile = path.join(distDir, 'server', 'middleware.js')\n    const middlewareTrace = `${middlewareFile}.nft.json`\n    await handleTraceFiles(middlewareTrace)\n  }\n\n  if (appPageKeys) {\n    for (const page of appPageKeys) {\n      if (middlewareManifest.functions.hasOwnProperty(page)) {\n        continue\n      }\n      const pageFile = path.join(distDir, 'server', 'app', `${page}.js`)\n      const pageTraceFile = `${pageFile}.nft.json`\n      await handleTraceFiles(pageTraceFile).catch((err) => {\n        Log.warn(`Failed to copy traced files for ${pageFile}`, err)\n      })\n    }\n  }\n\n  if (hasInstrumentationHook) {\n    await handleTraceFiles(\n      path.join(distDir, 'server', 'instrumentation.js.nft.json')\n    )\n  }\n\n  await handleTraceFiles(path.join(distDir, 'next-server.js.nft.json'))\n  const serverOutputPath = path.join(\n    outputPath,\n    path.relative(tracingRoot, dir),\n    'server.js'\n  )\n  await fs.mkdir(path.dirname(serverOutputPath), { recursive: true })\n\n  await fs.writeFile(\n    serverOutputPath,\n    `${\n      moduleType\n        ? `performance.mark('next-start');\nimport path from 'node:path'\nimport { fileURLToPath } from 'node:url'\nimport module from 'node:module'\nconst require = module.createRequire(import.meta.url)\nconst __dirname = fileURLToPath(new URL('.', import.meta.url))\n`\n        : `const path = require('path')`\n    }\n\nconst dir = path.join(__dirname)\n\nprocess.env.NODE_ENV = 'production'\nprocess.chdir(__dirname)\n\nconst currentPort = parseInt(process.env.PORT, 10) || 3000\nconst hostname = process.env.HOSTNAME || '0.0.0.0'\n\nlet keepAliveTimeout = parseInt(process.env.KEEP_ALIVE_TIMEOUT, 10)\nconst nextConfig = ${JSON.stringify(nextConfig)}\n\nprocess.env.__NEXT_PRIVATE_STANDALONE_CONFIG = JSON.stringify(nextConfig)\n\nrequire('next')\nconst { startServer } = require('next/dist/server/lib/start-server')\n\nif (\n  Number.isNaN(keepAliveTimeout) ||\n  !Number.isFinite(keepAliveTimeout) ||\n  keepAliveTimeout < 0\n) {\n  keepAliveTimeout = undefined\n}\n\nstartServer({\n  dir,\n  isDev: false,\n  config: nextConfig,\n  hostname,\n  port: currentPort,\n  allowRetry: false,\n  keepAliveTimeout,\n}).catch((err) => {\n  console.error(err);\n  process.exit(1);\n});`\n  )\n}\n\nexport function isReservedPage(page: string) {\n  return RESERVED_PAGE.test(page)\n}\n\nexport function isAppBuiltinPage(page: string) {\n  return /next[\\\\/]dist[\\\\/](esm[\\\\/])?client[\\\\/]components[\\\\/]builtin[\\\\/]/.test(\n    page\n  )\n}\n\nexport function isCustomErrorPage(page: string) {\n  return page === '/404' || page === '/500'\n}\n\nexport function isMiddlewareFile(file: string) {\n  return (\n    file === `/${MIDDLEWARE_FILENAME}` ||\n    file === `/src/${MIDDLEWARE_FILENAME}` ||\n    file === `/${PROXY_FILENAME}` ||\n    file === `/src/${PROXY_FILENAME}`\n  )\n}\n\nexport function isProxyFile(file: string) {\n  return file === `/${PROXY_FILENAME}` || file === `/src/${PROXY_FILENAME}`\n}\n\nexport function isInstrumentationHookFile(file: string) {\n  return (\n    file === `/${INSTRUMENTATION_HOOK_FILENAME}` ||\n    file === `/src/${INSTRUMENTATION_HOOK_FILENAME}`\n  )\n}\n\nexport function getPossibleInstrumentationHookFilenames(\n  folder: string,\n  extensions: string[]\n) {\n  const files = []\n  for (const extension of extensions) {\n    files.push(\n      path.join(folder, `${INSTRUMENTATION_HOOK_FILENAME}.${extension}`),\n      path.join(folder, `src`, `${INSTRUMENTATION_HOOK_FILENAME}.${extension}`)\n    )\n  }\n\n  return files\n}\n\nexport function getPossibleMiddlewareFilenames(\n  folder: string,\n  extensions: string[]\n) {\n  return extensions.flatMap((extension) => [\n    path.join(folder, `${MIDDLEWARE_FILENAME}.${extension}`),\n    path.join(folder, `${PROXY_FILENAME}.${extension}`),\n  ])\n}\n\nexport class NestedMiddlewareError extends Error {\n  constructor(\n    nestedFileNames: string[],\n    mainDir: string,\n    pagesOrAppDir: string\n  ) {\n    super(\n      `Nested Middleware is not allowed, found:\\n` +\n        `${nestedFileNames.map((file) => `pages${file}`).join('\\n')}\\n` +\n        `Please move your code to a single file at ${path.join(\n          path.posix.sep,\n          path.relative(mainDir, path.resolve(pagesOrAppDir, '..')),\n          'middleware'\n        )} instead.\\n` +\n        `Read More - https://nextjs.org/docs/messages/nested-middleware`\n    )\n  }\n}\n\nexport function getSupportedBrowsers(\n  dir: string,\n  isDevelopment: boolean\n): string[] {\n  let browsers: any\n  try {\n    const browsersListConfig = browserslist.loadConfig({\n      path: dir,\n      env: isDevelopment ? 'development' : 'production',\n    })\n    // Running `browserslist` resolves `extends` and other config features into a list of browsers\n    if (browsersListConfig && browsersListConfig.length > 0) {\n      browsers = browserslist(browsersListConfig)\n    }\n  } catch {}\n\n  // When user has browserslist use that target\n  if (browsers && browsers.length > 0) {\n    return browsers\n  }\n\n  // Uses modern browsers as the default.\n  return MODERN_BROWSERSLIST_TARGET\n}\n\nexport function shouldUseReactServerCondition(\n  layer: WebpackLayerName | null | undefined\n): boolean {\n  return Boolean(\n    layer && WEBPACK_LAYERS.GROUP.serverOnly.includes(layer as any)\n  )\n}\n\nexport function isWebpackClientOnlyLayer(\n  layer: WebpackLayerName | null | undefined\n): boolean {\n  return Boolean(\n    layer && WEBPACK_LAYERS.GROUP.clientOnly.includes(layer as any)\n  )\n}\n\nexport function isWebpackDefaultLayer(\n  layer: WebpackLayerName | null | undefined\n): boolean {\n  return (\n    layer === null ||\n    layer === undefined ||\n    layer === WEBPACK_LAYERS.pagesDirBrowser ||\n    layer === WEBPACK_LAYERS.pagesDirEdge ||\n    layer === WEBPACK_LAYERS.pagesDirNode\n  )\n}\n\nexport function isWebpackBundledLayer(\n  layer: WebpackLayerName | null | undefined\n): boolean {\n  return Boolean(layer && WEBPACK_LAYERS.GROUP.bundled.includes(layer as any))\n}\n\nexport function isWebpackAppPagesLayer(\n  layer: WebpackLayerName | null | undefined\n): boolean {\n  return Boolean(layer && WEBPACK_LAYERS.GROUP.appPages.includes(layer as any))\n}\n\nexport function collectMeta({\n  status,\n  headers,\n}: {\n  status?: number\n  headers?: OutgoingHttpHeaders\n}): {\n  status?: number\n  headers?: Record<string, string>\n} {\n  const meta: {\n    status?: number\n    headers?: Record<string, string>\n  } = {}\n\n  if (status !== 200) {\n    meta.status = status\n  }\n\n  if (headers && Object.keys(headers).length) {\n    meta.headers = {}\n\n    // normalize header values as initialHeaders\n    // must be Record<string, string>\n    for (const key in headers) {\n      // set-cookie is already handled - the middleware cookie setting case\n      // isn't needed for the prerender manifest since it can't read cookies\n      if (key === 'x-middleware-set-cookie') continue\n\n      let value = headers[key]\n\n      if (Array.isArray(value)) {\n        if (key === 'set-cookie') {\n          value = value.join(',')\n        } else {\n          value = value[value.length - 1]\n        }\n      }\n\n      if (typeof value === 'string') {\n        meta.headers[key] = value\n      }\n    }\n  }\n\n  return meta\n}\n\nexport const RSPACK_DEFAULT_LAYERS_REGEX = new RegExp(\n  `^(|${[WEBPACK_LAYERS.pagesDirBrowser, WEBPACK_LAYERS.pagesDirEdge, WEBPACK_LAYERS.pagesDirNode].join('|')})$`\n)\n\n/**\n * Converts a page to a manifest route.\n *\n * @param page The page to convert to a route.\n * @returns A route object.\n */\nexport function pageToRoute(page: string): ManifestRoute\n/**\n * Converts a page to a dynamic manifest route.\n *\n * @param page The page to convert to a route.\n * @param sourcePage The source page that this route is based on. This is used\n * to determine the source page for the route and is only relevant for app\n * pages when PPR is enabled on them.\n * @returns A route object.\n */\nexport function pageToRoute(\n  page: string,\n  sourcePage: string | undefined\n): DynamicManifestRoute\nexport function pageToRoute(\n  page: string,\n  sourcePage?: string\n): DynamicManifestRoute | ManifestRoute {\n  const routeRegex = getNamedRouteRegex(page, {\n    prefixRouteKeys: true,\n  })\n  return {\n    sourcePage,\n    page,\n    regex: normalizeRouteRegex(routeRegex.re.source),\n    routeKeys: routeRegex.routeKeys,\n    namedRegex: routeRegex.namedRegex,\n  }\n}\n"],"names":["checkIsRoutePPREnabled","normalizeRouteRegex","INSTRUMENTATION_HOOK_FILENAME","MIDDLEWARE_FILENAME","SERVER_PROPS_GET_INIT_PROPS_CONFLICT","SERVER_PROPS_SSG_CONFLICT","SSG_GET_INITIAL_PROPS_CONFLICT","WEBPACK_LAYERS","PROXY_FILENAME","bold","cyan","green","red","underline","yellow","textTable","path","promises","fs","isValidElementType","stripAnsi","browserslist","MODERN_BROWSERSLIST_TARGET","UNDERSCORE_GLOBAL_ERROR_ROUTE","UNDERSCORE_GLOBAL_ERROR_ROUTE_ENTRY","UNDERSCORE_NOT_FOUND_ROUTE","isDynamicRoute","findPageFile","isEdgeRuntime","Log","loadComponents","trace","setHttpClientAndAgentOptions","Sema","normalizePagePath","getRuntimeContext","RouteKind","collectSegments","createIncrementalCache","collectRootParamKeys","buildAppStaticPaths","buildPagesStaticPaths","formatExpire","formatRevalidate","formatIssue","isRelevantWarning","getNamedRouteRegex","parseAppRoute","fillMetadataSegment","STATIC_METADATA_IMAGES","staticMetadataImageFilenames","Set","Object","values","map","meta","filename","getTreeViewDisplayPath","pagePath","lastSlash","lastIndexOf","slice","dotIndex","baseName","has","segment","lastSegment","print","console","log","RESERVED_PAGE","unique","main","sub","difference","a","b","filter","x","isMiddlewareFilename","file","isInstrumentationHookFilename","filterAndSortList","list","routeType","hasCustomApp","pages","e","sort","localeCompare","collectRoutesUsingEdgeRuntime","input","routesUsingEdgeRuntime","route","info","entries","runtime","printBuildErrors","entrypoints","isDev","topLevelFatalIssues","topLevelErrors","topLevelWarnings","seenFatalIssues","seenErrors","seenWarnings","issue","issues","severity","formatted","add","push","length","warn","join","error","Error","printTreeView","lists","pageInfos","pagesDir","pageExtensions","middlewareManifest","functionsConfigManifest","useStaticPages404","hasGSPAndRevalidateZero","MIN_DURATION","process","env","__NEXT_PRIVATE_DETERMINISTIC_BUILD_OUTPUT","Infinity","getPrettyDuration","_duration","duration","usedSymbols","messages","printFileTree","routerType","filteredPages","showRevalidate","showExpire","page","cacheControl","get","initialCacheControl","revalidate","expire","entry","forEach","item","i","arr","pageInfo","border","totalDuration","pageDuration","ssgPageDurations","reduce","symbol","isRoutePPREnabled","hasEmptyStaticShell","isDynamicAppRoute","hasPostponed","isStatic","isSSG","displayPath","ssgPageRoutes","totalRoutes","contSymbol","routes","some","d","previewPages","Math","min","routesWithDuration","idx","remainingRoutes","remaining","avgDuration","round","total","index","innerSymbol","app","set","includes","middleware","files","functions","align","stringLength","str","staticFunctionInfo","printCustomRoutes","redirects","rewrites","headers","printRoutes","type","isRedirects","isHeaders","routesStr","routeStr","source","r","destination","statusCode","permanent","header","last","key","value","combinedRewrites","beforeFiles","afterFiles","fallback","isPageStatic","dir","distDir","configFileName","httpAgentOptions","locales","defaultLocale","parentId","pageRuntime","edgeInfo","pageType","cacheComponents","authInterrupts","originalAppPath","isrFlushToDisk","cacheMaxMemorySize","nextConfigOutput","cacheHandler","cacheHandlers","cacheLifeProfiles","pprConfig","buildId","sriEnabled","prerenderFallbackMode","undefined","prerenderedRoutes","rootParamKeys","hasStaticProps","hasServerProps","isNextImageImported","appConfig","flushToDisk","isPageStaticSpan","traceAsyncFn","componentsResult","pathIsEdgeRuntime","paths","edgeFunctionEntry","wasm","binding","filePath","name","useCache","mod","context","_ENTRIES","ComponentMod","buildManifest","Component","default","Document","App","routeModule","pageConfig","config","reactLoadableManifest","getServerSideProps","getStaticPaths","getStaticProps","isAppPath","needsManifestsForLegacyReasons","Comp","segments","err","cause","reduceAppConfig","dynamic","definition","kind","APP_PAGE","dynamicSegments","fallbackMode","requestHeaders","hasGetInitialProps","getInitialProps","hasStaticPaths","pageIsDynamic","globalThis","__NEXT_IMAGE_IMPORTED","catch","message","fetchCache","preferredRegion","maxDuration","hasCustomGetInitialProps","checkingApp","_app","origGetInitialProps","getDefinedNamedExports","keys","detectConflictingPaths","combinedPages","ssgPages","additionalGeneratedSSGPaths","conflictingPaths","Map","dynamicSsgPages","additionalSsgPathsByPath","pathsPage","curPath","currentPath","toLowerCase","lowerPath","conflictingPage","find","conflictingPath","size","conflictingPathsOutput","pathItems","pathItem","isDynamic","exit","copyTracedFiles","pageKeys","appPageKeys","tracingRoot","serverConfig","hasNodeMiddleware","hasInstrumentationHook","staticPages","outputPath","rm","recursive","force","moduleType","nextConfig","relative","packageJsonPath","packageJsonContent","readFile","packageJson","JSON","parse","packageJsonOutputPath","mkdir","dirname","writeFile","copiedFiles","handleTraceFiles","traceFilePath","traceData","copySema","capacity","traceFileDir","Promise","all","relativeFile","acquire","tracedFilePath","fileOutputPath","symlink","readlink","platform","code","isAbsolute","junctionErr","copyFile","release","handleEdgeFunction","handleFile","originalPath","assets","edgeFunctionHandlers","hasOwnProperty","pageFile","pageTraceFile","middlewareFile","middlewareTrace","serverOutputPath","stringify","isReservedPage","test","isAppBuiltinPage","isCustomErrorPage","isMiddlewareFile","isProxyFile","isInstrumentationHookFile","getPossibleInstrumentationHookFilenames","folder","extensions","extension","getPossibleMiddlewareFilenames","flatMap","NestedMiddlewareError","constructor","nestedFileNames","mainDir","pagesOrAppDir","posix","sep","resolve","getSupportedBrowsers","isDevelopment","browsers","browsersListConfig","loadConfig","shouldUseReactServerCondition","layer","Boolean","GROUP","serverOnly","isWebpackClientOnlyLayer","clientOnly","isWebpackDefaultLayer","pagesDirBrowser","pagesDirEdge","pagesDirNode","isWebpackBundledLayer","bundled","isWebpackAppPagesLayer","appPages","collectMeta","status","Array","isArray","RSPACK_DEFAULT_LAYERS_REGEX","RegExp","pageToRoute","sourcePage","routeRegex","prefixRouteKeys","regex","re","routeKeys","namedRegex"],"mappings":"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","ignoreList":[0]}