{"version":3,"sources":["../../../../../src/server/mcp/tools/get-logs.ts"],"sourcesContent":["/**\n * MCP tool for getting the path to the Next.js development log file.\n *\n * This tool returns the path to the {nextConfig.distDir}/logs/next-development.log file\n * that contains browser console logs and other development information.\n */\nimport type { McpServer } from 'next/dist/compiled/@modelcontextprotocol/sdk/server/mcp'\nimport { stat } from 'fs/promises'\nimport { join } from 'path'\nimport { mcpTelemetryTracker } from '../mcp-telemetry-tracker'\n\nexport function registerGetLogsTool(server: McpServer, distDir: string) {\n  server.registerTool(\n    'get_logs',\n    {\n      description:\n        'Get the path to the Next.js development log file. Returns the file path so the agent can read the logs directly.',\n    },\n    async () => {\n      // Track telemetry\n      mcpTelemetryTracker.recordToolCall('mcp/get_logs')\n\n      try {\n        const logFilePath = join(distDir, 'logs', 'next-development.log')\n\n        // Check if the log file exists\n        try {\n          await stat(logFilePath)\n        } catch (error) {\n          return {\n            content: [\n              {\n                type: 'text',\n                text: JSON.stringify({\n                  error: `Log file not found at ${logFilePath}.`,\n                }),\n              },\n            ],\n          }\n        }\n\n        return {\n          content: [\n            {\n              type: 'text',\n              text: JSON.stringify({\n                logFilePath,\n              }),\n            },\n          ],\n        }\n      } catch (error) {\n        return {\n          content: [\n            {\n              type: 'text',\n              text: JSON.stringify({\n                error: `Error getting log file path: ${error instanceof Error ? error.message : String(error)}`,\n              }),\n            },\n          ],\n        }\n      }\n    }\n  )\n}\n"],"names":["stat","join","mcpTelemetryTracker","registerGetLogsTool","server","distDir","registerTool","description","recordToolCall","logFilePath","error","content","type","text","JSON","stringify","Error","message","String"],"mappings":"AAAA;;;;;CAKC,GAED,SAASA,IAAI,QAAQ,cAAa;AAClC,SAASC,IAAI,QAAQ,OAAM;AAC3B,SAASC,mBAAmB,QAAQ,2BAA0B;AAE9D,OAAO,SAASC,oBAAoBC,MAAiB,EAAEC,OAAe;IACpED,OAAOE,YAAY,CACjB,YACA;QACEC,aACE;IACJ,GACA;QACE,kBAAkB;QAClBL,oBAAoBM,cAAc,CAAC;QAEnC,IAAI;YACF,MAAMC,cAAcR,KAAKI,SAAS,QAAQ;YAE1C,+BAA+B;YAC/B,IAAI;gBACF,MAAML,KAAKS;YACb,EAAE,OAAOC,OAAO;gBACd,OAAO;oBACLC,SAAS;wBACP;4BACEC,MAAM;4BACNC,MAAMC,KAAKC,SAAS,CAAC;gCACnBL,OAAO,CAAC,sBAAsB,EAAED,YAAY,CAAC,CAAC;4BAChD;wBACF;qBACD;gBACH;YACF;YAEA,OAAO;gBACLE,SAAS;oBACP;wBACEC,MAAM;wBACNC,MAAMC,KAAKC,SAAS,CAAC;4BACnBN;wBACF;oBACF;iBACD;YACH;QACF,EAAE,OAAOC,OAAO;YACd,OAAO;gBACLC,SAAS;oBACP;wBACEC,MAAM;wBACNC,MAAMC,KAAKC,SAAS,CAAC;4BACnBL,OAAO,CAAC,6BAA6B,EAAEA,iBAAiBM,QAAQN,MAAMO,OAAO,GAAGC,OAAOR,QAAQ;wBACjG;oBACF;iBACD;YACH;QACF;IACF;AAEJ","ignoreList":[0]}